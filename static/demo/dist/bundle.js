webpackJsonp([0],{157:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(54),r=n(420);t.App=function(){return o.createElement(o.View,null,o.createElement(o.Text,null,"TEST"),o.createElement(r.StripeTest,null))}},158:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(166);t.clientConfig=new o.ClientConfig({lookup_domain:"https://told-stack-demo.azureedge.net",downloadBlob_domain:"https://told-stack-demo.azureedge.net",lookup_route:"api/lookup-lsc",downloadBlob_route:"api/lookup-lsc-download"})},161:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(158);t.clientConfig_lookupLsc=o.clientConfig;var r=n(412);t.clientConfig_logger=r.clientConfig;var i=n(418);t.clientConfig_stripe=i.clientConfig},162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(54),r=n(157);o.App.initialize(!0,!0),o.UserInterface.setMainView(o.createElement(r.App,null))},163:function(e,t,n){"use strict";function o(e,t){return e.reduce(function(e,n){var o=t(n);return(e[o]=e[o]||{items:[]}).items.push(n),e},{})}function r(e,t){var n=o(e,t);return Object.getOwnPropertyNames(n).map(function(e){return n[e].items})}function i(e,t){for(var n in t)e[n]=t[n];return e}Object.defineProperty(t,"__esModule",{value:!0}),t.group=o,t.groupToArray=r,t.assignPartial=i},166:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(163),r=function(){function e(e){this.timePollSeconds=1,this.maxPollCount=5,this.timeToLiveSeconds=60,this.lookup_domain="/",this.lookup_route="api/lookup-lsc",this.downloadBlob_domain="/",this.downloadBlob_route="blob",this.shouldGzipDownloadBlob=!1,o.assignPartial(this,e)}return e.prototype.getLookupUrl=function(e){return this.lookup_domain+"/"+this.lookup_route+"/"+e.containerName+"/"+e.blobName},e.prototype.getDataDownloadUrl=function(e,t){return this.downloadBlob_domain+"/"+(this.downloadBlob_route?this.downloadBlob_route+"/":"")+e.containerName+"/"+this.getDataDownloadBlobName(e.blobName,t)},e.prototype.getDataDownloadBlobName=function(e,t){return e+"/"+t.timeKey+(this.shouldGzipDownloadBlob?"_gzip":"")},e}();t.ClientConfig=r},412:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(413);t.clientConfig=new o.ClientConfig({timeBatchSeconds:10,sendLog_domain:"https://told-stack-demo.azureedge.net",sendLog_route:"api/logger/send-log"})},413:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(163),r=function(){function e(e){var t=this;this.maxSendSize=32768,this.maxDataSize=28672,this.sendLog_domain="/",this.sendLog_route="api/logger/send-log",this.getSendLogUrl=function(){return t.sendLog_domain+"/"+t.sendLog_route},o.assignPartial(this,e)}return e}();t.ClientConfig=r},416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(417),r=n(161);t.logger=new o.Logger(r.clientConfig_logger,function(){return{sessionId:"s1234",userId:"u1234"}},function(){return{path:"a/b/c"}},function(){return{appVersion:"v1.0",platform:"web",userAgent:"testUserAgent"}})},417:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,a)}u((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n,o){var r=this;this.config=e,this.getUserInfo=t,this.getContextInfo=n,this.getDeviceInfo=o,this._hasSentSessionInfo=!1,this._startTime=Date.now(),this._lastSendTime=Date.now(),this._items=[],this._timeoutId=0,this.sendBatch=function(e){if(void 0===e&&(e=!1),!e&&Date.now()-r._lastSendTime<1e3*r.config.timeBatchSeconds)return void r.scheduleSend();var t=r._items;r._items=[],r.sendNow(t)},this.scheduleSend=function(){var e=Date.now()-r._lastSendTime,t=r.config.timeBatchSeconds-e;clearTimeout(r._timeoutId),r._timeoutId=setTimeout(r.sendBatch,t)},setTimeout(function(){return r.sendSessionInfo()},250)}return e.prototype.sendSessionInfo=function(){this._hasSentSessionInfo||(this._hasSentSessionInfo=!0,this._items.push({category:"Session",event:"Info",data:null,userInfo:this.getUserInfo(),appContextInfo:this.getContextInfo(),deviceInfo:this.getDeviceInfo(),isError:void 0,time:Date.now(),runTime:Date.now()-this._startTime,startTime:this._startTime}),this.sendBatch(!0))},e.prototype.error=function(e,t,n,o){void 0===o&&(o=!1),this.log(e,t,n,!0,!0)},e.prototype.major=function(e,t,n,o){void 0===o&&(o=!1),this.log(e,t,n,!0)},e.prototype.log=function(e,t,n,o,r){void 0===o&&(o=!1),void 0===r&&(r=!1);var i={category:e,event:t,data:n,userInfo:this.getUserInfo(),appContextInfo:this.getContextInfo(),deviceInfo:void 0,isError:r,time:Date.now(),runTime:Date.now()-this._startTime,startTime:this._startTime};this._items.push(i),this.sendBatch(o)},e.prototype.sendNow=function(e){return o(this,void 0,void 0,function(){var t,n,o,i,s,a,u,c=this;return r(this,function(r){switch(r.label){case 0:if(this._lastSendTime=Date.now(),!e||!e.length)return[2];for(e.forEach(function(e){if(e.data){var t=e.data;"string"!=typeof e.data&&(t=JSON.stringify(e.data)),t.length>c.config.maxDataSize&&(e.data="truncated:"+t.substr(0,c.config.maxDataSize-16)+"...")}}),t=e,n=JSON.stringify(e),o=!0,i=e.length;n.length>this.config.maxSendSize;){if(1===i){t.forEach(function(e){return e.data="truncated:"+JSON.stringify(e.data).substr(0,c.config.maxDataSize)+"..."});break}o=!1,i=Math.floor(i/2),t=e.slice(0,i),n=JSON.stringify(t)}return o||(a=this._items).push.apply(a,e.slice(i)),[4,fetch(this.config.getSendLogUrl(),{method:"POST",body:n})];case 1:return s=r.sent(),s.ok||(t.forEach(function(e){return e._attempts++}),(u=this._items).push.apply(u,t.filter(function(e){return e._attempts<c.config.maxItemSendAttempts}))),o||setTimeout(function(){return c.sendBatch(!0)}),[2]}})})},e}();t.Logger=i},418:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(419);t.clientConfig=new o.ClientConfig({stripePublishableKey:"pk_test_hB4VRQY8ICsC6mVsRo8jjnIh",checkoutOptions:{business:{name:"Told Software",imageUrl:"https://toldstackdemo.blob.core.windows.net/images/ToldLogo128.png"},requirements:{requireZipCode:!0,requireBillingAddress:!0},experience:{allowRememberMe:!0}}})},419:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(163),r=function(){function e(e){this.options=e,o.assignPartial(this,e)}return e}();t.ClientConfig=r},420:function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,a)}u((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(54),a=n(421),u=n(426),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prepare=function(){return r(t,void 0,void 0,function(){var e,t=this;return i(this,function(n){switch(n.label){case 0:return[4,a.stripeCheckoutProcess.prepare()];case 1:return e=n.sent(),this.setState({isReady:!0,open:e.open}),e.result.subscribe(function(e){console.log("Result Changed",{result:e}),t.setState({result:e})}),[2]}})})},t.open=function(){t.state.open&&t.state.open({product:{amountCents:100,description:"Cool Thing to Buy"},user:{email:"me@home.com"}})},t}return o(t,e),t.prototype.render=function(){return this.state.hasStarted||(this.setState({hasStarted:!0}),setTimeout(this.prepare)),s.createElement(s.View,null,s.createElement(s.Button,{disabled:!this.state.isReady,onPress:this.open},"Checkout"),this.state.result&&s.createElement(s.View,null,s.createElement(s.Text,null,"status: ",u.CheckoutStatus[this.state.result.status]),s.createElement(s.Text,null,"checkoutId: ",this.state.result.checkoutId),s.createElement(s.Text,null,"timeChanged: ",this.state.result.timeChanged)))},t}(s.Component);t.StripeTest=c},421:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(427),r=n(161),i=n(416);t.stripeCheckoutProcess=new o.StripeCheckoutProcess(r.clientConfig_stripe,{logCheckoutEvent:function(e,t){i.logger.major("Stripe",e,t)}})},422:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){var t=this;this._load=e,this._isLoading=!1,this._resolves=[],this._getInstance=function(){return new Promise(function(e,n){if(t._instance)return e(t._instance);t._resolves.push(e),t._isLoading||(t._isLoading=!0,console.log("InstanceLoader START"),t._load().then(function(e){console.log("InstanceLoader LOADED"),t._instance=e;var n=t._resolves;t._resolves=null,n.forEach(function(t){setTimeout(function(){try{t(e)}catch(e){console.error("InstanceLoader: A resolver threw an uncaught error",{err:e})}})}),console.log("InstanceLoader DONE")}))})}}return e.prototype.load=function(){return this._getInstance()},Object.defineProperty(e.prototype,"instance",{get:function(){return this._getInstance()},enumerable:!0,configurable:!0}),e}();t.InstanceLoader=o},423:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(429);t.Observable=o.default},424:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){var t=this;this.options=e,this.hasStartedLoading=!1,this.resolves=[],this.resolveAll=function(){var e=t.resolves;t.resolves=[],e.forEach(function(e){return e(t.instance)})}}return e.prototype.load=function(){var e=this;return new Promise(function(t,n){if(e.instance)return void t(e.instance);if(e.resolves.push(t),!e.hasStartedLoading){e.hasStartedLoading=!0,console.log("ScriptLoader.load START"),e.options.onBeforeLoadScript&&e.options.onBeforeLoadScript();var o=document,r="script",i=e.options.scriptElementId;if(o.getElementById(i))return void e.resolveAll();var s=o.getElementsByTagName(r)[0],a=o.createElement(r);a.id=i,a.onload=function(){e.options.onAfterLoadScript&&e.options.onAfterLoadScript(),e.instance=e.options.getInstance(),e.resolveAll()},a.src=e.options.url,s.parentNode.insertBefore(a,s)}})},e}();t.ScriptLoader=o},425:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuid={v4:function(){return(""+1e7+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^16*Math.random()>>e/4).toString(16)})}}},426:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Opened=2]="Opened",e[e.Closed=3]="Closed",e[e.Verifing=4]="Verifing",e[e.Submitting=5]="Submitting",e[e.Processing=6]="Processing",e[e.Success=7]="Success",e[e.PaymentFailed=8]="PaymentFailed",e[e.ProcessingFailed=9]="ProcessingFailed",e[e.NotFound=10]="NotFound"}(t.CheckoutStatus||(t.CheckoutStatus={}))},427:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,a)}u((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(423),s=n(426),a=n(428),u=n(163),c=n(425),l=function(){function e(e,t){var n=this;this.config=e,this.runtime=t,this.prepare=function(){return o(n,void 0,void 0,function(){var e,t,n,o,l,f,h,d=this;return r(this,function(r){switch(r.label){case 0:return console.log("StripeCheckoutProcess START"),this._access||(this._access=new a.StripeCheckoutAccess(this.config.stripePublishableKey)),console.log("StripeCheckoutProcess Prepare Stripe Access"),[4,this._access.prepare()];case 1:return r.sent(),console.log("StripeCheckoutProcess Setup Result Observer"),e=c.uuid.v4(),n={checkoutId:e,status:s.CheckoutStatus.NotStarted,timeChanged:Date.now()},o=function(o){if(console.log("StripeCheckoutProcess updateResult",{result:o}),o.checkoutId&&o.checkoutId!==n.checkoutId)throw"StripeCheckoutProcess: Cannot change checkoutId";u.assignPartial(n,o),n.checkoutId=e,n.timeChanged=Date.now(),t.next(n),d.runtime.logCheckoutEvent("ResultChange",n)},l=new i.Observable(function(e){console.log("StripeCheckoutProcess Observable START"),t=e}),f=function(e,t){o({status:s.CheckoutStatus.Submitting})},h=function(t){var r={};u.assignPartial(r,d.config.checkoutOptions),u.assignPartial(r,t),d._access.open({tokenCallback:f,recommendedOptions:{amount:r.product.amountCents,name:r.business.name,image:r.business.imageUrl,description:r.product.description,zipCode:r.requirements.requireZipCode,billingAddress:r.requirements.requireBillingAddress},additionalOptions:{email:r.user.email,allowRememberMe:r.experience.allowRememberMe,opened:function(){o({status:s.CheckoutStatus.Opened})},closed:function(){n.status<s.CheckoutStatus.Submitting&&o({status:s.CheckoutStatus.Closed})}}}),d.runtime.logCheckoutEvent("Open",{checkoutId:e,openOptions:t,configOptions:d.config.checkoutOptions}),o({status:s.CheckoutStatus.Started})},console.log("StripeCheckoutProcess DONE"),[2,{open:h,result:l}]}})})}}return e.prototype.getResult=function(e){throw new Error("Method not implemented.")},e}();t.StripeCheckoutProcess=l},428:function(e,t,n){"use strict";var o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,a)}u((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(424),a=n(422),u=new s.ScriptLoader({url:"https://checkout.stripe.com/checkout.js",scriptElementId:"StripeCheckout",getInstance:function(){return StripeCheckout}}),c=function(){function e(e){var t=this;this.stripePublishableKey=e,this.handlerLoader=new a.InstanceLoader(function(){return r(t,void 0,void 0,function(){var e,t;return i(this,function(n){switch(n.label){case 0:return console.log("StripeCheckoutProcess.handlerLoader START"),[4,u.load()];case 1:return e=n.sent(),console.log("StripeCheckoutProcess.handlerLoader LOADED"),[4,e.configure({key:this.stripePublishableKey})];case 2:return t=n.sent(),console.log("StripeCheckoutProcess.handlerLoader END"),[2,t]}})})}),this.prepare=function(){return r(t,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return e=this,[4,this.handlerLoader.instance];case 1:return e._handler=t.sent(),[2]}})})},this.open=function(e){var n=t._handler;if(!n)throw"The Stripe Checkout Handler must be loaded before Open is Clicked";n.open(o({token:e.tokenCallback},e.recommendedOptions,e.additionalOptions))}}return e}();t.StripeCheckoutAccess=c}},[162]);
//# sourceMappingURL=bundle.js.map