webpackJsonp([0],{157:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(54),r=n(159);e.App=function(){return o.createElement(o.View,null,o.createElement(o.Text,null,"TEST"),o.createElement(r.LookupLscTest,null))}},158:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(164);e.clientConfig=new o.ClientConfig({lookup_domain:"https://told-stack-demo.azureedge.net",downloadBlob_domain:"https://told-stack-demo.azureedge.net",lookup_route:"api/lookup-lsc",downloadBlob_route:"api/lookup-lsc-download"})},159:function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{s(o.next(t))}catch(t){i(t)}}function u(t){try{s(o.throw(t))}catch(t){i(t)}}function s(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,u)}s((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,a,u,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return u={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u};Object.defineProperty(e,"__esModule",{value:!0});var a=n(54),u=n(160),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.notifyUpdate=function(t){return r(e,void 0,void 0,function(){var e;return i(this,function(n){return e=t,this.setState({hasStarted:!0,isWaitingForUpdate:!1,obj:e}),[2]})})},e.download=function(){return r(e,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return[4,u.lookupLscDataAccess.readAndUpdate({blobName:"test",containerName:"test"},{shouldAutoRefresh:!0},this.notifyUpdate)];case 1:return t=e.sent(),this.setState({hasStarted:!0,isWaitingForUpdate:!0,obj:t}),[2]}})})},e}return o(e,t),e.prototype.render=function(){return this.state.hasStarted||(this.setState({hasStarted:!0}),setTimeout(this.download)),a.createElement(a.View,null,a.createElement(a.Text,null,"hasStarted: ",""+this.state.hasStarted),a.createElement(a.Text,null,"isWaitingForUpdate: ",""+this.state.isWaitingForUpdate),a.createElement(a.Text,null,JSON.stringify(this.state.obj)))},e}(a.Component);e.LookupLscTest=s},160:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(163),r=n(158);e.lookupLscDataAccess=new o.DataAccess(r.clientConfig)},161:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(54),r=n(157);o.App.initialize(!0,!0),o.UserInterface.setMainView(o.createElement(r.App,null))},162:function(t,e,n){"use strict";function o(t,e,n){void 0===e&&(e=1e3);var o=n.maxTime,r=n.maxAttempts||(o?void 0:5),u=n.base||2,s=i.length;i.push(0);var l=0,c=function(){if(t(),i[s]!==a&&(l++,!r||l<r)){var n=e*Math.pow(u,l),f=o?Math.min(o,n):n;console.log("setInterval_exponentialBackoff",{actualTime:f,backoffTime:n,timeMs:e,maxTime:o,maxAttempts:r,base:u}),i[s]=setTimeout(function(){c()},f)}};return c(),s}function r(t){clearTimeout(i[t]),i[t]=a}Object.defineProperty(e,"__esModule",{value:!0});var i=[],a=-1;e.setInterval_exponentialBackoff=o,e.clearInterval_exponentialBackoff=r},163:function(t,e,n){"use strict";function o(t,e){return u(this,void 0,void 0,function(){var n;return s(this,function(o){switch(o.label){case 0:return[4,r(t,e)];case 1:return n=o.sent().data,[2,n]}})})}function r(t,e){return u(this,void 0,void 0,function(){var n,o;return s(this,function(r){switch(r.label){case 0:return[4,l.default(t.getLookupUrl(e))];case 1:return n=r.sent(),[4,n.json()];case 2:return o=r.sent(),o.error?[2,{data:null,lookup:o}]:[3,3];case 3:return[4,i(t,e,o)];case 4:return[2,r.sent()]}})})}function i(t,e,n){return u(this,void 0,void 0,function(){var o,r;return s(this,function(i){switch(i.label){case 0:return[4,l.default(t.getDataDownloadUrl(e,n))];case 1:return o=i.sent(),[4,o.json()];case 2:return r=i.sent(),[2,{data:r,lookup:n}]}})})}function a(t,e,n,o){return u(this,void 0,void 0,function(){var a,f,d,p,h,b,v=this;return s(this,function(m){switch(m.label){case 0:return[4,r(t,e)];case 1:return a=m.sent(),f=a.data,d=a.lookup,o&&(p=0,h=function(){clearTimeout(p)},(b=function(){var r=c.setInterval_exponentialBackoff(function(){return u(v,void 0,void 0,function(){var a,u,f;return s(this,function(s){switch(s.label){case 0:return[4,l.default(t.getLookupUrl(e))];case 1:return a=s.sent(),[4,a.json()];case 2:return u=s.sent(),JSON.stringify(u.timeKey)===JSON.stringify(d.timeKey)?[3,4]:(d=u,c.clearInterval_exponentialBackoff(r),[4,i(t,e,u)]);case 3:f=s.sent().data,o(f,h),n.shouldAutoRefresh&&(p=setTimeout(b,1e3*d.timeToExpireSeconds)),s.label=4;case 4:return[2]}})})},1e3*t.timePollSeconds,{maxAttempts:n.shouldAutoRefresh?void 0:t.maxPollCount,maxTime:n.shouldAutoRefresh?1e3*t.timeToLiveSeconds/2:void 0})})()),[2,f]}})})}var u=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{s(o.next(t))}catch(t){i(t)}}function u(t){try{s(o.throw(t))}catch(t){i(t)}}function s(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,u)}s((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,a,u,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return u={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u};Object.defineProperty(e,"__esModule",{value:!0});var l=n(406),c=n(162),f=function(){function t(t){this.config=t}return t.prototype.read=function(t){return u(this,void 0,void 0,function(){return s(this,function(e){return[2,o(this.config,t)]})})},t.prototype.readAndUpdate=function(t,e,n){return u(this,void 0,void 0,function(){return s(this,function(o){return[2,a(this.config,t,e,n)]})})},t}();e.DataAccess=f,e.readAppBlob=o,e.readAppBlob_inner=r,e.readAppBlobData=i,e.readAppBlobAndUpdate=a},164:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){this.timePollSeconds=1,this.maxPollCount=5,this.timeToLiveSeconds=60,this.lookup_domain="/",this.lookup_route="api/lookup-lsc",this.downloadBlob_domain="/",this.downloadBlob_route="blob",this.shouldGzipDownloadBlob=!1,Object.assign(this,t)}return t.prototype.getLookupUrl=function(t){return this.lookup_domain+"/"+this.lookup_route+"/"+t.containerName+"/"+t.blobName},t.prototype.getDataDownloadUrl=function(t,e){return this.downloadBlob_domain+"/"+(this.downloadBlob_route?this.downloadBlob_route+"/":"")+t.containerName+"/"+this.getDataDownloadBlobName(t.blobName,e)},t.prototype.getDataDownloadBlobName=function(t,e){return t+"/"+e.timeKey+(this.shouldGzipDownloadBlob?"_gzip":"")},t}();e.ClientConfig=o},409:function(t,e){}},[161]);
//# sourceMappingURL=bundle.js.map