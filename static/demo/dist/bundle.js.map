{"version":3,"sources":["webpack:///bundle.js","webpack:///./src/app/app.tsx","webpack:///./src/app/components/lookup-lsc-test.tsx","webpack:///./src/app/server-access/lookup-lsc-data-access.ts","webpack:///./src/index.tsx","webpack:///./../../../told-stack-npm/src/core/utils/objects.ts","webpack:///./../../../told-stack-npm/src/core/utils/time.ts","webpack:///./../../../told-stack-npm/src/data-patterns/lookup-lsc/src-client/data-access.ts","webpack:///./../../../told-stack-npm/src/data-patterns/lookup-lsc/src-config/client-config.ts","webpack:///./../config/src/lookup-lsc/client.ts","webpack:///./src/config.ts"],"names":["webpackJsonp","157","module","exports","__webpack_require__","Object","defineProperty","value","RX","lookup_lsc_test_1","App","createElement","View","Text","LookupLscTest","159","__extends","this","extendStatics","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","verb","n","v","op","f","TypeError","_","y","t","call","label","ops","pop","trys","length","push","g","sent","throw","return","Symbol","iterator","lookup_lsc_data_access_1","_super","_this","arguments","notifyUpdate","data","timeToExpireSeconds","cancel","obj","_a","setState","hasStarted","downloadTimeoutId","download","delay","clearTimeout","setTimeout","state","lookupLscDataAccess","readAndUpdate","containerName","blobName","shouldAutoRefresh","undefined","setContainerName","setBlobName","render","JSON","stringify","TextInput","onChangeText","Component","160","data_access_1","config_1","DataAccess","clientConfig_lookupLsc","161","app_1","initialize","UserInterface","setMainView","162","group","items","getKey","reduce","o","x","k","groupToArray","getOwnPropertyNames","map","assignPartial","163","setInterval_exponentialBackoff","callback","timeMs","options","maxTime","maxAttempts","base","id","ids","attempt","CANCEL","backoffTime","Math","pow","actualTime","min","console","log","clearInterval_exponentialBackoff","164","readAppBlob","config","key","readAppBlob_inner","rLookup","lookup","node_fetch_1","default","getLookupUrl","json","error","readAppBlobData","r","getDataDownloadUrl","readAppBlobAndUpdate","refreshIntervalId_1","cancel_1","lookupLoop_1","_b","clearInterval","time_1","lookup_old","rLookup_update","data_1","timeKey","err","__assign","setInterval","timeToLiveSeconds","assign","s","i","read","165","objects_1","ClientConfig","timePollSeconds","maxPollCount","lookup_domain","lookup_route","downloadBlob_domain","downloadBlob_route","shouldGzipDownloadBlob","getDataDownloadBlobName","410","411","client_config_1","clientConfig","412","client_1"],"mappings":"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","file":"bundle.js","sourcesContent":["webpackJsonp([0],{\n\n/***/ 157:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar RX = __webpack_require__(54);\r\nvar lookup_lsc_test_1 = __webpack_require__(159);\r\n// import { Store } from './store/store';\r\n// import { handleRoute } from \"./routes\";\r\n// import { Root } from \"./components/page/root\";\r\n// const store = Store;\r\n// handleRoute();\r\n// <Root store={store} />\r\nexports.App = function () { return (RX.createElement(RX.View, null,\r\n    RX.createElement(RX.Text, null, \"TEST\"),\r\n    RX.createElement(lookup_lsc_test_1.LookupLscTest, null))); };\r\n\n\n/***/ }),\n\n/***/ 159:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar RX = __webpack_require__(54);\r\nvar lookup_lsc_data_access_1 = __webpack_require__(160);\r\nvar LookupLscTest = (function (_super) {\r\n    __extends(LookupLscTest, _super);\r\n    function LookupLscTest() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.notifyUpdate = function (data, timeToExpireSeconds, cancel) { return __awaiter(_this, void 0, void 0, function () {\r\n            var obj;\r\n            return __generator(this, function (_a) {\r\n                obj = data;\r\n                this.setState({\r\n                    cancel: cancel,\r\n                    hasStarted: true,\r\n                    timeToExpireSeconds: timeToExpireSeconds,\r\n                    obj: obj\r\n                });\r\n                return [2 /*return*/];\r\n            });\r\n        }); };\r\n        _this.downloadTimeoutId = 0;\r\n        _this.download = function (delay) {\r\n            if (delay === void 0) { delay = 1000; }\r\n            clearTimeout(_this.downloadTimeoutId);\r\n            _this.downloadTimeoutId = setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\r\n                var obj;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            if (this.state.cancel) {\r\n                                this.state.cancel();\r\n                            }\r\n                            return [4 /*yield*/, lookup_lsc_data_access_1.lookupLscDataAccess.readAndUpdate({\r\n                                    containerName: this.state.containerName,\r\n                                    blobName: this.state.blobName\r\n                                }, { shouldAutoRefresh: true }, this.notifyUpdate)];\r\n                        case 1:\r\n                            obj = _a.sent();\r\n                            this.setState({\r\n                                hasStarted: true,\r\n                                timeToExpireSeconds: undefined,\r\n                                obj: obj\r\n                            });\r\n                            return [2 /*return*/];\r\n                    }\r\n                });\r\n            }); }, delay);\r\n        };\r\n        _this.setContainerName = function (value) {\r\n            _this.setState({\r\n                containerName: value,\r\n            });\r\n            _this.download(3000);\r\n        };\r\n        _this.setBlobName = function (value) {\r\n            _this.setState({\r\n                blobName: value,\r\n            });\r\n            _this.download(3000);\r\n        };\r\n        return _this;\r\n    }\r\n    LookupLscTest.prototype.render = function () {\r\n        if (!this.state.hasStarted) {\r\n            this.setState({\r\n                containerName: 'test',\r\n                blobName: 'test',\r\n                hasStarted: true,\r\n            });\r\n            this.download(0);\r\n        }\r\n        return (RX.createElement(RX.View, null,\r\n            RX.createElement(RX.Text, null,\r\n                \"hasStarted: \",\r\n                '' + this.state.hasStarted),\r\n            RX.createElement(RX.Text, null,\r\n                \"timeToExpireSeconds: \",\r\n                '' + this.state.timeToExpireSeconds),\r\n            RX.createElement(RX.Text, null, JSON.stringify(this.state.obj)),\r\n            RX.createElement(RX.View, null,\r\n                \"Container: \",\r\n                RX.createElement(RX.TextInput, { value: this.state.containerName, onChangeText: this.setContainerName })),\r\n            RX.createElement(RX.View, null,\r\n                \"Blob: \",\r\n                RX.createElement(RX.TextInput, { value: this.state.blobName, onChangeText: this.setBlobName }))));\r\n    };\r\n    return LookupLscTest;\r\n}(RX.Component));\r\nexports.LookupLscTest = LookupLscTest;\r\n\n\n/***/ }),\n\n/***/ 160:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar data_access_1 = __webpack_require__(164);\r\nvar config_1 = __webpack_require__(412);\r\nexports.lookupLscDataAccess = new data_access_1.DataAccess(config_1.clientConfig_lookupLsc);\r\n\n\n/***/ }),\n\n/***/ 161:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar RX = __webpack_require__(54);\r\nvar app_1 = __webpack_require__(157);\r\nRX.App.initialize(true, true);\r\nRX.UserInterface.setMainView(RX.createElement(app_1.App, null));\r\n\n\n/***/ }),\n\n/***/ 162:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\n// export function objectToValueIterator<T>(obj: { [key: string]: T }): { [key: string]: T } & Iterable<T> {\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n//     const o = obj as any;\r\n//     o[Symbol.iterator] = () => {\r\n//         let keys = Object.getOwnPropertyNames(obj);\r\n//         let i = 0;\r\n//         return {\r\n//             next: () => {\r\n//                 const key = keys[i++];\r\n//                 const value = obj[key];\r\n//                 return {\r\n//                     value,\r\n//                     done: i >= keys.length\r\n//                 };\r\n//             }\r\n//         };\r\n//     };\r\n//     return o;\r\n// }\r\n// export function objectToKeyValueIterator<T>(obj: { [key: string]: T }): { [key: string]: T } & Iterable<{ key: string, value: T }> {\r\n//     const o = obj as any;\r\n//     o[Symbol.iterator] = () => {\r\n//         let keys = Object.getOwnPropertyNames(obj);\r\n//         let i = 0;\r\n//         return {\r\n//             next: () => {\r\n//                 const key = keys[i++];\r\n//                 const value = obj[key];\r\n//                 return {\r\n//                     value: { key, value },\r\n//                     done: i >= keys.length\r\n//                 };\r\n//             }\r\n//         };\r\n//     };\r\n//     return o;\r\n// }\r\nfunction group(items, getKey) {\r\n    var g = items.reduce(function (o, x) {\r\n        var k = getKey(x);\r\n        var group = o[k] = o[k] || { items: [] };\r\n        group.items.push(x);\r\n        return o;\r\n    }, {});\r\n    //return objectToValueIterator(g);\r\n    return g;\r\n}\r\nexports.group = group;\r\nfunction groupToArray(items, getKey) {\r\n    var g = group(items, getKey);\r\n    return Object.getOwnPropertyNames(g).map(function (k) { return g[k].items; });\r\n}\r\nexports.groupToArray = groupToArray;\r\nfunction assignPartial(t, p) {\r\n    for (var k in p) {\r\n        t[k] = p[k];\r\n    }\r\n    return t;\r\n}\r\nexports.assignPartial = assignPartial;\r\n\n\n/***/ }),\n\n/***/ 163:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ids = [];\r\nvar CANCEL = -1;\r\nfunction setInterval_exponentialBackoff(callback, timeMs, options) {\r\n    if (timeMs === void 0) { timeMs = 1000; }\r\n    options = options || {};\r\n    var maxTime = options.maxTime;\r\n    var maxAttempts = options.maxAttempts || (!maxTime ? 5 : undefined);\r\n    var base = options.base || 2;\r\n    var id = ids.length;\r\n    ids.push(0);\r\n    var attempt = -1;\r\n    var call = function () {\r\n        callback();\r\n        if (ids[id] === CANCEL) {\r\n            return;\r\n        }\r\n        attempt++;\r\n        if (!maxAttempts || attempt < maxAttempts) {\r\n            var backoffTime = timeMs * Math.pow(base, attempt);\r\n            var actualTime = maxTime ? Math.min(maxTime, backoffTime) : backoffTime;\r\n            console.log('setInterval_exponentialBackoff', { actualTime: actualTime, backoffTime: backoffTime, timeMs: timeMs, maxTime: maxTime, maxAttempts: maxAttempts, base: base });\r\n            ids[id] = setTimeout(function () {\r\n                call();\r\n            }, actualTime);\r\n        }\r\n    };\r\n    call();\r\n    return id;\r\n}\r\nexports.setInterval_exponentialBackoff = setInterval_exponentialBackoff;\r\nfunction clearInterval_exponentialBackoff(id) {\r\n    clearTimeout(ids[id]);\r\n    ids[id] = CANCEL;\r\n}\r\nexports.clearInterval_exponentialBackoff = clearInterval_exponentialBackoff;\r\n\n\n/***/ }),\n\n/***/ 164:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n            t[p] = s[p];\r\n    }\r\n    return t;\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar node_fetch_1 = __webpack_require__(407);\r\nvar time_1 = __webpack_require__(163);\r\nvar DataAccess = (function () {\r\n    function DataAccess(config) {\r\n        this.config = config;\r\n    }\r\n    DataAccess.prototype.read = function (key) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2 /*return*/, readAppBlob(this.config, key)];\r\n            });\r\n        });\r\n    };\r\n    DataAccess.prototype.readAndUpdate = function (key, options, notifyUpdate) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2 /*return*/, readAppBlobAndUpdate(this.config, key, options, notifyUpdate)];\r\n            });\r\n        });\r\n    };\r\n    return DataAccess;\r\n}());\r\nexports.DataAccess = DataAccess;\r\nfunction readAppBlob(config, key) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var data;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, readAppBlob_inner(config, key)];\r\n                case 1:\r\n                    data = (_a.sent()).data;\r\n                    return [2 /*return*/, data];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.readAppBlob = readAppBlob;\r\nfunction readAppBlob_inner(config, key) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var rLookup, lookup;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, node_fetch_1.default(config.getLookupUrl(key))];\r\n                case 1:\r\n                    rLookup = _a.sent();\r\n                    return [4 /*yield*/, rLookup.json()];\r\n                case 2:\r\n                    lookup = _a.sent();\r\n                    if (!lookup.error) return [3 /*break*/, 3];\r\n                    return [2 /*return*/, { data: null, lookup: lookup }];\r\n                case 3: return [4 /*yield*/, readAppBlobData(config, key, lookup)];\r\n                case 4: return [2 /*return*/, _a.sent()];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.readAppBlob_inner = readAppBlob_inner;\r\nfunction readAppBlobData(config, key, lookup) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var r, data;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, node_fetch_1.default(config.getDataDownloadUrl(key, lookup))];\r\n                case 1:\r\n                    r = _a.sent();\r\n                    return [4 /*yield*/, r.json()];\r\n                case 2:\r\n                    data = _a.sent();\r\n                    return [2 /*return*/, { data: data, lookup: lookup }];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.readAppBlobData = readAppBlobData;\r\nfunction readAppBlobAndUpdate(config, key, options, notifyUpdate) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var _this = this;\r\n        var _a, data, lookup, refreshIntervalId_1, cancel_1, lookupLoop_1;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0: return [4 /*yield*/, readAppBlob_inner(config, key)];\r\n                case 1:\r\n                    _a = _b.sent(), data = _a.data, lookup = _a.lookup;\r\n                    if (notifyUpdate) {\r\n                        refreshIntervalId_1 = 0;\r\n                        cancel_1 = function () {\r\n                            clearInterval(refreshIntervalId_1);\r\n                            time_1.clearInterval_exponentialBackoff(refreshIntervalId_1);\r\n                        };\r\n                        lookupLoop_1 = function () { return __awaiter(_this, void 0, void 0, function () {\r\n                            var lookup_old, rLookup_update, data_1;\r\n                            return __generator(this, function (_a) {\r\n                                switch (_a.label) {\r\n                                    case 0:\r\n                                        console.log('readAppBlobAndUpdate lookupLoop');\r\n                                        lookup_old = lookup;\r\n                                        return [4 /*yield*/, node_fetch_1.default(config.getLookupUrl(key))];\r\n                                    case 1:\r\n                                        rLookup_update = _a.sent();\r\n                                        return [4 /*yield*/, rLookup_update.json()];\r\n                                    case 2:\r\n                                        lookup = (_a.sent());\r\n                                        if (!(JSON.stringify(lookup_old) !== JSON.stringify(lookup))) return [3 /*break*/, 6];\r\n                                        if (!(JSON.stringify(lookup_old.timeKey) !== JSON.stringify(lookup.timeKey))) return [3 /*break*/, 5];\r\n                                        if (!lookup.error) return [3 /*break*/, 3];\r\n                                        notifyUpdate(null, lookup.timeToExpireSeconds, cancel_1);\r\n                                        return [3 /*break*/, 5];\r\n                                    case 3: return [4 /*yield*/, readAppBlobData(config, key, lookup)];\r\n                                    case 4:\r\n                                        data_1 = (_a.sent()).data;\r\n                                        try {\r\n                                            notifyUpdate(data_1, lookup.timeToExpireSeconds, cancel_1);\r\n                                        }\r\n                                        catch (err) {\r\n                                            console.error('readAppBlobAndUpdate notifyUpdate ERROR', { err: err });\r\n                                        }\r\n                                        _a.label = 5;\r\n                                    case 5:\r\n                                        if (options.shouldAutoRefresh) {\r\n                                            console.log('readAppBlobAndUpdate AutoRefresh', __assign({}, lookup));\r\n                                            cancel_1();\r\n                                            refreshIntervalId_1 = setInterval(lookupLoop_1, lookup.timeToExpireSeconds * 1000);\r\n                                        }\r\n                                        _a.label = 6;\r\n                                    case 6: return [2 /*return*/];\r\n                                }\r\n                            });\r\n                        }); };\r\n                        console.log('readAppBlobAndUpdate Loop Start', __assign({}, lookup));\r\n                        refreshIntervalId_1 = time_1.setInterval_exponentialBackoff(lookupLoop_1, lookup.timeToExpireSeconds * 1000 / (1 + 2 + 4), { maxTime: config.timeToLiveSeconds * 1000 });\r\n                    }\r\n                    return [2 /*return*/, data];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.readAppBlobAndUpdate = readAppBlobAndUpdate;\r\n\n\n/***/ }),\n\n/***/ 165:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar objects_1 = __webpack_require__(162);\r\nvar ClientConfig = (function () {\r\n    function ClientConfig(options) {\r\n        this.timePollSeconds = 1;\r\n        this.maxPollCount = 5;\r\n        this.timeToLiveSeconds = 60;\r\n        this.lookup_domain = '/';\r\n        this.lookup_route = 'api/lookup-lsc';\r\n        this.downloadBlob_domain = '/';\r\n        this.downloadBlob_route = 'blob';\r\n        // WARNING: Gzip is not working in the 4th step: Reading from .gzip blob with node and sending to client\r\n        // In addition, since using a function instead of proxy, gzip is done automatically by the function\r\n        // So it is not needed, and would only be useful to reduce storage size at the cost of increased processing\r\n        this.shouldGzipDownloadBlob = false;\r\n        objects_1.assignPartial(this, options);\r\n    }\r\n    ClientConfig.prototype.getLookupUrl = function (key) {\r\n        return this.lookup_domain + \"/\" + this.lookup_route + \"/\" + key.containerName + \"/\" + key.blobName;\r\n    };\r\n    ClientConfig.prototype.getDataDownloadUrl = function (key, lookup) {\r\n        return this.downloadBlob_domain + \"/\" + (this.downloadBlob_route ? this.downloadBlob_route + '/' : '') + key.containerName + \"/\" + this.getDataDownloadBlobName(key.blobName, lookup);\r\n    };\r\n    ClientConfig.prototype.getDataDownloadBlobName = function (blobName, lookup) {\r\n        // TODO: Test if works with .ext and switch to underscore if needed\r\n        return blobName + \"/\" + lookup.timeKey + (this.shouldGzipDownloadBlob ? '_gzip' : '');\r\n    };\r\n    return ClientConfig;\r\n}());\r\nexports.ClientConfig = ClientConfig;\r\n\n\n/***/ }),\n\n/***/ 410:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 411:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar client_config_1 = __webpack_require__(165);\r\nexports.clientConfig = new client_config_1.ClientConfig({\r\n    // lookup_domain: 'https://told-stack-demo.azurewebsites.net',\r\n    // downloadBlob_domain: 'https://told-stack-demo.azurewebsites.net',\r\n    lookup_domain: 'https://told-stack-demo.azureedge.net',\r\n    downloadBlob_domain: 'https://told-stack-demo.azureedge.net',\r\n    lookup_route: 'api/lookup-lsc',\r\n    downloadBlob_route: 'api/lookup-lsc-download'\r\n});\r\n\n\n/***/ }),\n\n/***/ 412:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar client_1 = __webpack_require__(411);\r\nexports.clientConfig_lookupLsc = client_1.clientConfig;\r\n\n\n/***/ })\n\n},[161]);\n\n\n// WEBPACK FOOTER //\n// bundle.js","import * as RX from 'reactxp';\r\nimport { LookupLscTest } from \"./components/lookup-lsc-test\";\r\n// import { Store } from './store/store';\r\n// import { handleRoute } from \"./routes\";\r\n// import { Root } from \"./components/page/root\";\r\n\r\n// const store = Store;\r\n\r\n// handleRoute();\r\n\r\n// <Root store={store} />\r\nexport const App = () => (\r\n    <RX.View>\r\n        <RX.Text>TEST</RX.Text>\r\n        <LookupLscTest />\r\n    </RX.View>\r\n);\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.tsx","import * as RX from 'reactxp';\r\nimport { lookupLscDataAccess } from \"../server-access/lookup-lsc-data-access\";\r\n\r\n\r\nexport class LookupLscTest extends RX.Component<{}, {\r\n    containerName: string,\r\n    blobName: string,\r\n    hasStarted: boolean,\r\n    timeToExpireSeconds: number,\r\n    obj: any,\r\n    cancel: () => void\r\n}>{\r\n\r\n    notifyUpdate = async (data: any, timeToExpireSeconds: number, cancel: () => void) => {\r\n        const obj = data;\r\n\r\n        this.setState({\r\n            cancel,\r\n            hasStarted: true,\r\n            timeToExpireSeconds,\r\n            obj\r\n        } as any);\r\n    }\r\n\r\n    downloadTimeoutId: any = 0;\r\n    download = (delay = 1000) => {\r\n        clearTimeout(this.downloadTimeoutId);\r\n        this.downloadTimeoutId = setTimeout(async () => {\r\n            if (this.state.cancel) { this.state.cancel(); }\r\n\r\n            const obj = await lookupLscDataAccess.readAndUpdate({\r\n                containerName: this.state.containerName,\r\n                blobName: this.state.blobName\r\n            }, { shouldAutoRefresh: true }, this.notifyUpdate);\r\n\r\n            this.setState({\r\n                hasStarted: true,\r\n                timeToExpireSeconds: undefined,\r\n                obj\r\n            } as any);\r\n        }, delay);\r\n    }\r\n\r\n    setContainerName = (value: string) => {\r\n        this.setState({\r\n            containerName: value,\r\n        } as any);\r\n\r\n        this.download(3000);\r\n    }\r\n\r\n    setBlobName = (value: string) => {\r\n        this.setState({\r\n            blobName: value,\r\n        } as any);\r\n\r\n        this.download(3000);\r\n    }\r\n\r\n    render() {\r\n\r\n        if (!this.state.hasStarted) {\r\n            this.setState({\r\n                containerName: 'test',\r\n                blobName: 'test',\r\n                hasStarted: true,\r\n            } as any);\r\n\r\n            this.download(0);\r\n        }\r\n\r\n        return (\r\n            <RX.View>\r\n                <RX.Text>hasStarted: {'' + this.state.hasStarted}</RX.Text>\r\n                <RX.Text>timeToExpireSeconds: {'' + this.state.timeToExpireSeconds}</RX.Text>\r\n                <RX.Text>{JSON.stringify(this.state.obj)}</RX.Text>\r\n                <RX.View>Container: <RX.TextInput value={this.state.containerName} onChangeText={this.setContainerName} /></RX.View>\r\n                <RX.View>Blob: <RX.TextInput value={this.state.blobName} onChangeText={this.setBlobName} /></RX.View>\r\n            </RX.View>\r\n        );\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/components/lookup-lsc-test.tsx","import { DataAccess } from '@told/stack/src/data-patterns/lookup-lsc/src-client/data-access';\r\nimport { clientConfig_lookupLsc as clientConfig } from '../../config';\r\n\r\nexport const lookupLscDataAccess = new DataAccess(clientConfig);\n\n\n// WEBPACK FOOTER //\n// ./src/app/server-access/lookup-lsc-data-access.ts","import * as RX from 'reactxp';\r\nimport { App } from './app/app';\r\n\r\nRX.App.initialize(true, true);\r\nRX.UserInterface.setMainView(<App />);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.tsx","\r\n// export function objectToValueIterator<T>(obj: { [key: string]: T }): { [key: string]: T } & Iterable<T> {\r\n\r\n//     const o = obj as any;\r\n//     o[Symbol.iterator] = () => {\r\n//         let keys = Object.getOwnPropertyNames(obj);\r\n//         let i = 0;\r\n\r\n//         return {\r\n//             next: () => {\r\n//                 const key = keys[i++];\r\n//                 const value = obj[key];\r\n//                 return {\r\n//                     value,\r\n//                     done: i >= keys.length\r\n//                 };\r\n//             }\r\n//         };\r\n//     };\r\n\r\n//     return o;\r\n// }\r\n\r\n\r\n// export function objectToKeyValueIterator<T>(obj: { [key: string]: T }): { [key: string]: T } & Iterable<{ key: string, value: T }> {\r\n\r\n//     const o = obj as any;\r\n//     o[Symbol.iterator] = () => {\r\n//         let keys = Object.getOwnPropertyNames(obj);\r\n//         let i = 0;\r\n\r\n//         return {\r\n//             next: () => {\r\n//                 const key = keys[i++];\r\n//                 const value = obj[key];\r\n//                 return {\r\n//                     value: { key, value },\r\n//                     done: i >= keys.length\r\n//                 };\r\n//             }\r\n//         };\r\n//     };\r\n\r\n//     return o;\r\n// }\r\n\r\nexport function group<T>(items: T[], getKey: (x: T) => string) {\r\n    const g = items.reduce((o, x) => {\r\n        const k = getKey(x);\r\n        const group = o[k] = o[k] || { items: [] };\r\n        group.items.push(x);\r\n        return o;\r\n    }, {} as any) as { [key: string]: { items: T[] } };\r\n\r\n    //return objectToValueIterator(g);\r\n    return g;\r\n}\r\n\r\nexport function groupToArray<T>(items: T[], getKey: (x: T) => string) {\r\n    const g = group(items, getKey);\r\n    return Object.getOwnPropertyNames(g).map(k => g[k].items);\r\n}\r\n\r\n\r\nexport function assignPartial<T>(t: T, p: Partial<T>): T {\r\n    for (let k in p) {\r\n        t[k] = p[k];\r\n    }\r\n\r\n    return t;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./../../../told-stack-npm/src/core/utils/objects.ts","const ids: any[] = [];\r\nconst CANCEL = -1;\r\n\r\nexport function setInterval_exponentialBackoff(callback: () => void, timeMs = 1000, options?: {\r\n    maxAttempts?: number,\r\n    base?: number,\r\n    maxTime?: number,\r\n}): number {\r\n\r\n    options = options || {};\r\n    const maxTime = options.maxTime;\r\n    const maxAttempts = options.maxAttempts || (!maxTime ? 5 : undefined);\r\n    const base = options.base || 2;\r\n\r\n    const id = ids.length;\r\n    ids.push(0);\r\n\r\n    let attempt = -1;\r\n\r\n    const call = () => {\r\n        callback();\r\n        if (ids[id] === CANCEL) { return; }\r\n\r\n        attempt++;\r\n\r\n        if (!maxAttempts || attempt < maxAttempts) {\r\n            const backoffTime = timeMs * Math.pow(base, attempt);\r\n            const actualTime = maxTime ? Math.min(maxTime, backoffTime) : backoffTime;\r\n            console.log('setInterval_exponentialBackoff', { actualTime, backoffTime, timeMs, maxTime, maxAttempts, base });\r\n\r\n            ids[id] = setTimeout(() => {\r\n                call();\r\n            }, actualTime);\r\n        }\r\n    };\r\n\r\n    call();\r\n    return id;\r\n}\r\n\r\nexport function clearInterval_exponentialBackoff(id: number) {\r\n    clearTimeout(ids[id]);\r\n    ids[id] = CANCEL;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./../../../told-stack-npm/src/core/utils/time.ts","import fetch from 'node-fetch';\r\nimport { ClientConfigType, DataKey, LookupResponse, LookupData } from \"../src-config/client-config\";\r\nimport { setInterval_exponentialBackoff, clearInterval_exponentialBackoff } from \"../../../core/utils/time\";\r\n\r\ninterface NotifyUpdateOptions {\r\n    shouldAutoRefresh: boolean;\r\n}\r\n\r\nexport class DataAccess<T> {\r\n    constructor(private config: ClientConfigType) { }\r\n\r\n    async read(key: DataKey) {\r\n        return readAppBlob<T>(this.config, key);\r\n    }\r\n\r\n    async readAndUpdate(key: DataKey, options: NotifyUpdateOptions, notifyUpdate: (newData: T, timeToExpireSeconds: number, cancel: () => void) => void) {\r\n        return readAppBlobAndUpdate<T>(this.config, key, options, notifyUpdate);\r\n    }\r\n}\r\n\r\nexport async function readAppBlob<T>(config: ClientConfigType, key: DataKey) {\r\n    const { data } = await readAppBlob_inner<T>(config, key);\r\n    return data;\r\n}\r\n\r\nexport async function readAppBlob_inner<T>(config: ClientConfigType, key: DataKey) {\r\n    const rLookup = await fetch(config.getLookupUrl(key));\r\n    const lookup = await rLookup.json() as LookupResponse;\r\n    if (lookup.error) {\r\n        return { data: null as T, lookup };\r\n    } else {\r\n        return await readAppBlobData<T>(config, key, lookup);\r\n    }\r\n}\r\nexport async function readAppBlobData<T>(config: ClientConfigType, key: DataKey, lookup: LookupResponse) {\r\n    const r = await fetch(config.getDataDownloadUrl(key, lookup as LookupData));\r\n    const data = await r.json() as T;\r\n    return { data, lookup };\r\n}\r\n\r\nexport async function readAppBlobAndUpdate<T>(config: ClientConfigType, key: DataKey, options: NotifyUpdateOptions, notifyUpdate: (newData: T, timeToExpireSeconds: number, cancel: () => void) => void) {\r\n    let { data, lookup } = await readAppBlob_inner<T>(config, key);\r\n\r\n    if (notifyUpdate) {\r\n\r\n        let refreshIntervalId: any = 0;\r\n        const cancel = () => {\r\n            clearInterval(refreshIntervalId);\r\n            clearInterval_exponentialBackoff(refreshIntervalId);\r\n        };\r\n\r\n        const lookupLoop = async () => {\r\n            console.log('readAppBlobAndUpdate lookupLoop');\r\n            const lookup_old = lookup;\r\n\r\n            const rLookup_update = await fetch(config.getLookupUrl(key));\r\n            lookup = await rLookup_update.json() as LookupResponse;\r\n\r\n            if (JSON.stringify(lookup_old) !== JSON.stringify(lookup)) {\r\n                if (JSON.stringify(lookup_old.timeKey) !== JSON.stringify(lookup.timeKey)) {\r\n                    if (lookup.error) {\r\n                        notifyUpdate(null, lookup.timeToExpireSeconds, cancel);\r\n                    } else {\r\n                        const { data } = await readAppBlobData<T>(config, key, lookup);\r\n                        try {\r\n                            notifyUpdate(data, lookup.timeToExpireSeconds, cancel);\r\n                        } catch (err) {\r\n                            console.error('readAppBlobAndUpdate notifyUpdate ERROR', { err });\r\n                        }\r\n                    }\r\n                }\r\n\r\n\r\n                if (options.shouldAutoRefresh) {\r\n                    console.log('readAppBlobAndUpdate AutoRefresh', { ...lookup });\r\n                    cancel();\r\n                    refreshIntervalId = setInterval(lookupLoop, lookup.timeToExpireSeconds * 1000);\r\n                }\r\n            }\r\n\r\n        };\r\n\r\n        console.log('readAppBlobAndUpdate Loop Start', { ...lookup });\r\n        refreshIntervalId = setInterval_exponentialBackoff(lookupLoop, lookup.timeToExpireSeconds * 1000 / (1 + 2 + 4), { maxTime: config.timeToLiveSeconds * 1000 });\r\n    }\r\n\r\n    return data;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./../../../told-stack-npm/src/data-patterns/lookup-lsc/src-client/data-access.ts","import { HttpFunctionRequest } from \"../../../core/types/functions\";\r\nimport { assignPartial } from \"../../../core/utils/objects\";\r\n\r\nexport interface DataKey {\r\n    containerName: string;\r\n    blobName: string;\r\n}\r\n\r\nexport interface LookupData {\r\n    timeKey: string\r\n}\r\n\r\nexport interface LookupResponse {\r\n    timeKey?: string;\r\n    error?: string;\r\n    timeToExpireSeconds: number;\r\n}\r\n\r\nexport interface ClientConfigType {\r\n    timeToLiveSeconds: number;\r\n    timePollSeconds: number;\r\n    maxPollCount: number;\r\n\r\n    getLookupUrl(key: DataKey): string;\r\n    getDataDownloadUrl(key: DataKey, lookup: LookupData): string;\r\n}\r\n\r\nexport interface ClientConfigOptions {\r\n    timeToLiveSeconds: number;\r\n    timePollSeconds: number;\r\n    maxPollCount: number;\r\n    lookup_domain: string;\r\n    lookup_route: string;\r\n    downloadBlob_domain: string;\r\n    downloadBlob_route: string;\r\n}\r\n\r\nexport class ClientConfig implements ClientConfigType, ClientConfigOptions {\r\n    timePollSeconds = 1;\r\n    maxPollCount = 5;\r\n    timeToLiveSeconds = 60;\r\n\r\n    lookup_domain = '/';\r\n    lookup_route = 'api/lookup-lsc';\r\n    downloadBlob_domain = '/';\r\n    downloadBlob_route = 'blob';\r\n\r\n    // WARNING: Gzip is not working in the 4th step: Reading from .gzip blob with node and sending to client\r\n    // In addition, since using a function instead of proxy, gzip is done automatically by the function\r\n    // So it is not needed, and would only be useful to reduce storage size at the cost of increased processing\r\n    shouldGzipDownloadBlob = false;\r\n\r\n    constructor(options?: Partial<ClientConfigOptions>) {\r\n        assignPartial(this, options);\r\n    }\r\n\r\n    getLookupUrl(key: DataKey): string {\r\n        return `${this.lookup_domain}/${this.lookup_route}/${key.containerName}/${key.blobName}`;\r\n    }\r\n\r\n    getDataDownloadUrl(key: DataKey, lookup: LookupData): string {\r\n        return `${this.downloadBlob_domain}/${this.downloadBlob_route ? this.downloadBlob_route + '/' : ''}${key.containerName}/${this.getDataDownloadBlobName(key.blobName, lookup)}`;\r\n    }\r\n\r\n    getDataDownloadBlobName(blobName: string, lookup: LookupData) {\r\n        // TODO: Test if works with .ext and switch to underscore if needed\r\n        return `${blobName}/${lookup.timeKey}${this.shouldGzipDownloadBlob ? '_gzip' : ''}`;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./../../../told-stack-npm/src/data-patterns/lookup-lsc/src-config/client-config.ts","import { ClientConfig } from \"@told/stack/src/data-patterns/lookup-lsc/src-config/client-config\";\r\n\r\nexport const clientConfig = new ClientConfig({\r\n    // lookup_domain: 'https://told-stack-demo.azurewebsites.net',\r\n    // downloadBlob_domain: 'https://told-stack-demo.azurewebsites.net',\r\n    lookup_domain: 'https://told-stack-demo.azureedge.net',\r\n    downloadBlob_domain: 'https://told-stack-demo.azureedge.net',\r\n\r\n    lookup_route: 'api/lookup-lsc',\r\n    downloadBlob_route: 'api/lookup-lsc-download'\r\n});\n\n\n// WEBPACK FOOTER //\n// ./../config/src/lookup-lsc/client.ts","export { clientConfig as clientConfig_lookupLsc } from '../../config/src/lookup-lsc/client';\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.ts"],"sourceRoot":""}